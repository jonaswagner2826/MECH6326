%% Ergodic Chain
P = [0.5 0.5 0.0 0.0;...
     0.3 0.4 0.3 0.0;...
     0.0 0.3 0.4 0.3;...
     0.0 0.0 0.5 0.5];
figure; 
for i = 1:50
    imagesc(P^i)
    pause(0.2)
end
%%
d0 = [1 0 0 0];
d20 = d0*P^25
d0 = [0 0 0 1];
d20 = d0*P^25

%%
[V,D,W] = eig(P)
vec = [W(:,3)/sum(W(:,3))]'

%% Absorbing Chain
% P = [1.0 0.0 0.0 0.0 0.0 0.0 0.0;...
%      0.4 0.3 0.3 0.0 0.0 0.0 0.0;...
%      0.0 0.4 0.3 0.3 0.0 0.0 0.0;...
%      0.0 0.0 0.4 0.3 0.3 0.0 0.0;...
%      0.0 0.0 0.0 0.4 0.3 0.3 0.0;...
%      0.0 0.0 0.0 0.0 0.4 0.3 0.3;...
%      0.0 0.0 0.0 0.0 0.0 0.0 1.0];
P = [0.3 0.3 0.0 0.0 0.0 0.0 0.4;...
     0.4 0.3 0.3 0.0 0.0 0.0 0.0;...
     0.0 0.4 0.3 0.3 0.0 0.0 0.0;...
     0.0 0.0 0.4 0.3 0.3 0.0 0.0;...
     0.0 0.0 0.0 0.4 0.3 0.3 0.0;...
     0.0 0.0 0.0 0.0 0.0 1.0 0.0;...
     0.0 0.0 0.0 0.0 0.0 0.0 1.0];
figure; 
for i = 1:50
    imagesc(P^i)
    pause(0.2)
end 


%%
P = [0 1; 1 0];
figure
for i = 1:50
    imagesc(P^i)
    pause(0.2)
end 
 